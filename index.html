<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Rent House Scraper</title>
</head>
<body>
    <h1>Rent House Scraper</h1>

    <form id="filterForm">
        <div>
            <label>Region:</label>
            <div>
                <input type="checkbox" name="region" value="大安區"> 大安區
                <input type="checkbox" name="region" value="內湖區"> 內湖區
                <input type="checkbox" name="region" value="士林區"> 士林區
                <input type="checkbox" name="region" value="文山區"> 文山區
                <input type="checkbox" name="region" value="北投區"> 北投區
                <input type="checkbox" name="region" value="中山區"> 中山區
                <input type="checkbox" name="region" value="信義區"> 信義區
                <input type="checkbox" name="region" value="松山區"> 松山區
                <input type="checkbox" name="region" value="萬華區"> 萬華區
                <input type="checkbox" name="region" value="中正區"> 中正區
                <input type="checkbox" name="region" value="大同區"> 大同區
                <input type="checkbox" name="region" value="南港區"> 南港區
            </div>
        </div>
        <div>
            <label>Rent Type:</label>
            <div>
                <input type="checkbox" name="rentType" value="整層住家"> 整層住家
                <input type="checkbox" name="rentType" value="獨立套房"> 獨立套房
                <input type="checkbox" name="rentType" value="分租套房"> 分租套房
                <input type="checkbox" name="rentType" value="雅房"> 雅房
                <input type="checkbox" name="rentType" value="車位"> 車位
                <input type="checkbox" name="rentType" value="其他"> 其他
            </div>
        </div>
        <div>
            <label>Price:</label>
            <div>
                <input type="checkbox" name="price" value="5000元以下"> 5000元以下
                <input type="checkbox" name="price" value="5000-10000元"> 5000-10000元
                <input type="checkbox" name="price" value="10000-20000元"> 10000-20000元
                <input type="checkbox" name="price" value="20000-30000元"> 20000-30000元
                <input type="checkbox" name="price" value="40000元以上"> 40000元以上
            </div>
        </div>
        <div>
            <label>Filter:</label>
            <div>
                <input type="checkbox" name="filter" value="新上架"> 新上架
                <input type="checkbox" name="filter" value="近捷運"> 近捷運
                <input type="checkbox" name="filter" value="可養寵物"> 可養寵物
                <input type="checkbox" name="filter" value="可開伙"> 可開伙
                <input type="checkbox" name="filter" value="有車位"> 有車位
                <input type="checkbox" name="filter" value="有電梯"> 有電梯
                <input type="checkbox" name="filter" value="有陽台"> 有陽台
                <input type="checkbox" name="filter" value="可短期租賃"> 可短期租賃
            </div>
        </div>
        <div>
            <label>Type:</label>
            <div>
                <input type="checkbox" name="type" value="公寓"> 公寓
                <input type="checkbox" name="type" value="電梯大樓"> 電梯大樓
                <input type="checkbox" name="type" value="透天厝"> 透天厝
                <input type="checkbox" name="type" value="別墅"> 別墅
            </div>
        </div>
        <div>
            <label>坪數:</label>
            <div>
                <input type="checkbox" name="ping" value="不限"> 不限
                <input type="checkbox" name="ping" value="10坪以下"> 10坪以下
                <input type="checkbox" name="ping" value="10-20坪"> 10-20坪
                <input type="checkbox" name="ping" value="20-30坪"> 20-30坪
                <input type="checkbox" name="ping" value="30-40坪"> 30-40坪
                <input type="checkbox" name="ping" value="40-50坪"> 40-50坪
                <input type="checkbox" name="ping" value="50坪以上"> 50坪以上
            </div>
        </div>
        <div>
            <label>樓層:</label>
            <div>
                <input type="checkbox" name="floor" value="不限"> 不限
                <input type="checkbox" name="floor" value="1層"> 1層
                <input type="checkbox" name="floor" value="2-6層"> 2-6層
                <input type="checkbox" name="floor" value="6-12層"> 6-12層
                <input type="checkbox" name="floor" value="12層以上"> 12層以上
            </div>
        </div>
        <div>
            <label>衛浴:</label>
            <div>
                <input type="checkbox" name="bathroom" value="不限"> 不限
                <input type="checkbox" name="bathroom" value="1衛"> 1衛
                <input type="checkbox" name="bathroom" value="2衛"> 2衛
                <input type="checkbox" name="bathroom" value="3衛"> 3衛
                <input type="checkbox" name="bathroom" value="4衛及以上"> 4衛及以上
            </div>
        </div>
        <div>
            <label>設備:</label>
            <div>
                <input type="checkbox" name="equipment" value="不限"> 不限
                <input type="checkbox" name="equipment" value="有冷氣"> 有冷氣
                <input type="checkbox" name="equipment" value="有洗衣機"> 有洗衣機
                <input type="checkbox" name="equipment" value="有冰箱"> 有冰箱
                <input type="checkbox" name="equipment" value="有熱水器"> 有熱水器
                <input type="checkbox" name="equipment" value="有天然瓦斯"> 有天然瓦斯
                <input type="checkbox" name="equipment" value="有網路"> 有網路
                <input type="checkbox" name="equipment" value="床"> 床
            </div>
        </div>
        <div>
            <label>裝潢:</label>
            <div>
                <input type="checkbox" name="decoration" value="不限"> 不限
                <input type="checkbox" name="decoration" value="新裝潢"> 新裝潢
                <input type="checkbox" name="decoration" value="中檔裝潢"> 中檔裝潢
                <input type="checkbox" name="decoration" value="高檔裝潢"> 高檔裝潢
            </div>
        </div>
        <div>
            <label>須知:</label>
            <div>
                <input type="checkbox" name="requirement" value="不限"> 不限
                <input type="checkbox" name="requirement" value="男女皆可"> 男女皆可
                <input type="checkbox" name="requirement" value="限女生"> 限女生
                <input type="checkbox" name="requirement" value="限男生"> 限男生
                <input type="checkbox" name="requirement" value="排除頂樓加蓋"> 排除頂樓加蓋
            </div>
        </div>
        <button type="button" onclick="submitForm()">Submit</button>
    </form>
    <button id="submitForm">Start Scraping</button>
    <table id="rentHouseTable" border="1">
        <thead>
            <tr>
                <th>Title</th>
                <th>Tag</th>
                <th>Style</th>
                <th>Area</th>
                <th>Subway</th>
                <th>Bus</th>
                <th>Msg</th>
                <th>Price</th>
                <th>URL</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be inserted here -->
        </tbody>
    </table>


    <script>
        const ip = '118.150.108.41'
        function submitForm() {
            const form = document.getElementById('filterForm');
            const formData = new FormData(form);

            const params = {
                region: formData.getAll('region'),
                rentType: formData.getAll('rentType'),
                price: formData.getAll('price'),
                filter: formData.getAll('filter'),
                type: formData.getAll('type'),
                ping: formData.getAll('ping'),
                floor: formData.getAll('floor'),
                bathroom: formData.getAll('bathroom'),
                equipment: formData.getAll('equipment'),
                decoration: formData.getAll('decoration'),
                requirement: formData.getAll('requirement'),
            };
            console.table(params);

            fetch(`${ip}:8080/api/scrape`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(params)
            })
            .then(response => response.json())
                .then(data => {
                    const tableBody = document.getElementById('rentHouseTable').getElementsByTagName('tbody')[0];
                    tableBody.innerHTML = ''; // Clear existing rows

                    data.forEach(rentHouse => {
                        const row = tableBody.insertRow();
                        row.insertCell(0).innerText = rentHouse.title;
                        row.insertCell(1).innerText = rentHouse.tag;
                        row.insertCell(2).innerText = rentHouse.style;
                        row.insertCell(3).innerText = rentHouse.area;
                        row.insertCell(4).innerText = rentHouse.subway;
                        row.insertCell(5).innerText = rentHouse.bus;
                        row.insertCell(6).innerText = rentHouse.msg;
                        row.insertCell(7).innerText = rentHouse.price;
                        row.insertCell(7).innerText = rentHouse.url;
                        const urlCell = row.insertCell(8);
                        const link = document.createElement('a');
                        link.href = rentHouse.url;
                        link.innerText = 'Link';
                        link.target = '_blank';
                        urlCell.appendChild(link);
                    });
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }
    </script>
</body>
</html>
